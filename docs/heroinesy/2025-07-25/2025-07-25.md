# 네트워크

## Ch 1. 오리엔테이션

### 프로토콜
장비 간 정보를 주고받을 규칙이나 방법
호스트 간 합의된 의사소통 규칙
- OSI 모델 7계층 * 응표세전네데물
- TCP/IP 모델 4계층

- 캡슐화
상위 계층으로 내려받은 패킷을 페이로드로 삼아, 헤더를 덧붙이는 것
- 역캡슐화
캡슐화 과정에서 붙인 헤더를 각 계층에서 제거

- PDU 단위
응 - 데이터(data)
표 - 데이터(data)
세 - 데이터(data)
전 - 세그먼트(segment), 데이터그램(datagram)
네 - 패킷(packet)
데 - 프레임(frame)
물 - 비트(bit)

## Ch 2. 네트워크 액세스 계층

### 이더넷 (IEEE 802.3)
- 물리계층
- 데이터 계층
이더넷 프레임 : 이더넷 네트워크에서 주고받는 데이터 형식

| 헤더 구성                                     | 페이로드       | 트레일러 |
|----------------------------------------------|----------------|----------|
| 프리앰블(8) <br> 목적지 MAC 주소(6) <br> 송신지 MAC 주소(6) <br> 이더타입(2) | 데이터(46~1500) | FCS(4)   |

- 프리앰블
이더넷 프레임의 시작을 알리는 비트열, 송수신간의 동기화
- 목적지/송신지 MAC 주소
물리적 주소, 네트워크 장치(NIC)마다 할당된 고유 주소 (ex. ifconfig - ether)
- 이더타입/길이
1536 이상 : 이더타입(무엇을 캡슐화했는지)
1500 이하 : 길이
- 페이로드
운반할 데이터
- FCS
오류 검출을 위한 CRC 값이 명시되는 필드
  
* NIC (네트워크 인터페이스)
: 연결 매체를 통해 받은 신호를 컴퓨터에게 전달하는 하드웨어

### 허브와 CSMA/CD
허브(hub)
- 반이중 통신(half-duplex)
송수신이 한번에 하나만 이루어지는 통신(ex. 무전기)
동시에 허브로 데이터를 전송할 경우 충돌(collision)발생
=> 해결방법 : CSMA/CD

- 전이중 통신(full-duplex)
현재 흔히 사용하는 통신 방법, 양방향 동시 통신 가능 (허브 X)

CSMA/CD
1. CS (Carrier Sense)
: 반송파(캐리어) 감지, 메시지 전송 전 현재 전송 중인지 확인
2. MA (Multiple Access)
: 다중 접근, 두 개 이상의 호스트가 동시에 네트워크 접근 (충돌 발생)
3. CD (Collision Detection)
: 충돌 감지, Jam Signal을 보낸뒤 임의의 시간동안 대기 후 재전송

### 스위치와 VLAN
- 스위치 (전이중 모드)
데이터 링크 계층의 장비 -> MAC 주소 활용

- MAC 주소 활용
MAC 주소 학습 기능 (MAC 주소 테이블)
: 포트에 연결된 호스트와 MAC 주소의 관계를 기억하는 스위치 기능

학습 과정
1. 플러딩(flooding) : 허브와 같이 모든 포트에 프레임 전송
2. 포워딩과 필터링 : 어떤 포트로 내보낼지 내보내지 않을지 결정
3. 에이징 : 특정 시간이 지나면 MAC 주소 테이블 항목 삭제

- VLAN (Virtual LAN)
가상의 LAN, 물리적 위치에 관계없이 특정 LAN에 속할 수 있음
* VLAN을 나누게 되면 브로드캐스트 도메인이 나눠지고 같은 스위치에 물려있더라도, 
완전히 다른 LAN인 것처럼 네트워크 영역을 나눌 수가 있다. 
-> 브로드캐스트 범위를 나누거나 불필요한 트래픽을 막기 위해 사용 (VLAN끼리의 통신을 위해서는 네트워크 게층 통신 필요(라우팅))

### CH 3. 네트워크 계층

### IP (Internet Protocol)
DHCP 프로토콜을 통해 자동할당될 수도 있음
  - 단편화가 이루어지는 계층
  - 네트워크 간 통신이 가능한 계층 -> 라우팅
* 단편화 과정(프래그멘테이션, Fragmentation)
2GB 전송 -> MTU보다 크면 여러 개의 패킷으로 나누어 전송

MAC 주소 (수취인 개인정보) -> 물리 주소
IP 주소 (수취인 주소) -> 논리 주소

- 단편화
  - 패킷의 크기를 MTU(Maximum Transmission Unit) 이하로 유지
  - MTU 크기 이하로 단편화된 패킷들은 목적지에서 재조림 

- IPv4 헤더
- 송신지 IP 주소, 목적지 IP 주소
- 식별자, 플래그, 단편화 오프셋
  - 식별자 : 패킷에 할당된 번호
  - 플래그 : 부가 정보
  - 단편화 오프셋 : 단편화되기 전 데이터 위치
- TTL, 프로토콜
  - TTL(Time To Live) : 패킷의 수명
    TTL 값이 없으면 패킷이 무한히 라우터를 순환할 수 있음 (라우팅 루프 방지용)
  - 프로토콜 : 상위 계층의 프로토콜

### ARP
IP 주소를 통해 동일 네트워크 내의 호스트의 MAC 주소를 알아내기 위한 프로토콜

- 동작 과정
1. ARP 요청
2. 응답 : 요청에 대한 자신의 MAC 주소를 포함하여 응답
3. 테이블(ARP 캐시) 갱신 : MAC 주소와 IP 주소가 매핑된 표
ARP 테이블에 추가된 호스트는 더이상 브로드캐스트를 보낼 필요가 없음

- IP의 한계
1. 비신뢰성 : 패킷이 목적지까지 제대로 전송한다는 보장이 없는 특성
2. 비연결형 : 호스트 간의 사전 연결 수립이 없는 특성

 ### ICMP
IP의 비신뢰성과 비연결형 특성을 보완하기 위한 네트워크 계층 프로토콜
IP 패킷 전송 과정의 피드백 메세지 제공
  - 오류 보고
  - 네트워크 진단 보고

### IP 주소
- 네트워크 주소
- 호스트 주소

- class-less 주소체계
네트워크와 호스트를 구분하기 위해 서브넷 마스크 이용

- 서브넷 마스크 (CIDR 표기법)
네트워크와 호스트 부분을 구분
서브넷 마스크 & IP 주소 -> 네트워크 주소
* CIDR 표기
서브넷 마스크 상의 1의 개수를 뒤에 붙여 표현 (ex.192.168.100.103/30)

### IP 주소의 분류
NAT
공인 IP 주소와 사설 IP 주소 간의 변환 기능
- 하나의 공인 IP 주소를 여러 사설 IP 주소가 공유 가능

- 정적 IP 주소 (고정)
- 동적 IP 주소 (유동)
  - DHCP : DHCP 서버에 의해 동적으로 IP 주소 할당 (== IP 주소 임대)

### 라우팅
- 라우팅 : 패킷이 이동할 최적 경로 설정
- 홉 : 라우터 간의 패킷 이동 과정 (hop by hop)
- 라우팅 테이블(routing table) : 특정 목적지까지 도달하기 위한 정보를 명시하는 표
  - 목적지 주소
  - 서브넷 마스크
  - 게이트 웨이
  - 인터페이스
  - 메트릭

라우팅 프로토콜
  - AS 내부 라우팅 프로토콜(IGP) : RIP, OSPF
  - AS 외부 라우팅 프로토콜(EGP) : BGP
* AS == 동일한 라우팅 정책으로 운영되는 라우터들의 집단 네트워크
