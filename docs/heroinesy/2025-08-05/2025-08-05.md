- 백준 1032번 풀이

# 시스템 프로그래밍
## Ch 4. 소켓 프로그래밍
### 소켓이란
- 소켓 (socket)

네트워크를 경유하는 프로세스 간 통신의 종착점
프로세스 간 통신 기법(IPC)의 일종

- 소켓의 구성 요소
  - TCP/UDP + IP
  - 출발지 IP 주소, 포트 번호
  - 목적지 IP 주소, 포트 번호

### TCP 소켓 다루기
- 소켓 생성 
```int socket (int domain, int type, int protocol);```
  - Parameter
    - domain : 통신 도메인 지정
    - type : 통신 방법 지정
    - protocol : 특정 프로토콜 지정 -> 일반적으로 0으로 초기화
  - Return
    - 성공 : 소켓 디스크립터
    - 실패 : -1

- IP 주소를 소켓에 연결
```int bind (int socketfd, struct sockaddr *my_addr, socklen_t addrlen```
  - Parameter
    - socketfd : 생성된 소켓 디스크립터
    - my_addr : 호스트의 주소
    - addrlen : my_addr의 바이트 길이
  - Return
    - 성공 : 0
    - 실패 : -1

** IPv4 소켓을 표현하는 구조체
```
struct sockaddr_in {
    short      sin_family;        // 주소 체계 : AF_INET
    u_short    sin_port;          // 16비트 포트 번호, network byte order
    struct     in_addr sin_addr;  // 32 비트 IP 주소
    char       sin_zero[8];       // 전체 크기를 16 바이트로 맞추기 위한 dummy
};

* htons(포트번호) : 호스트 바이트 순서를 네트워크 바이트 순서로 변환
```

- LISTEN 상태(연결 요청 대기)로 전환
```int listen (int socketfd, int backlog);```
  - Parameter
    - socketfd : 소켓 디스크립터
    - backlog : 연결 요청을 담을 큐 (다수의 연결 요청이 들어올 수 있으므로)
  - Return
    - 성공 : 0
    - 실패 : -1

- 상대방 연결 요청 수락
```int accept (int socketfd, struct sockaddr *addr, socklen_t *addrlen);```
  - Parameter
    - socketfd : 소켓 디스크립터
    - addr : 연결 요청한 상대에 대한 정보
    - addrlen : addr의 바이트 단위 길이
  - Return
    - 성공 : 정수형의 소켓 디스크립터
    - 실패 : -1

- 연결 요청
```int connect (int sockfd, const struct sockaddr *serv_addr, socklen_t addrlen);```
  - Parameter
    - sockfd : 소켓 디스크립터
    - serv_addr : 통신을 연결할 상대에 대한 정보
    - addrlen : serv_addr의 길이
  - Return
    - 성공 : 0
    - 실패 : -1

- 메세지 송수신
```
int send (int sockfd, const void *msg, size_t msg_len, int flags); 
int recv (int sockfd, void *msg, size_t msg_len, int flags);
```
  - Parameter
    - sockfd : 송수신할 소켓 디스크립터
    - msg : 송수신할 메세지
    - msg_len : 메세지 길이
    - flags : 송수신 방법 -> 일반적으로 0
  - Return
    - send : 성공시 전송한 문자 수, 실패시 -1
    - recv : 성공시 전송한 바이트 수, 실패시 -1

- 연결 해제
```int close(int fd);```
  - Parameter
    - fd : 닫으려는 소켓 디스크립터 (파일 디스크립터로 close 하는 것과 동일)
  - Return
    - 성공 : 0
    - 실패 : -1

### UDP 소켓 다루기
- 소켓 생성
  - type
    - SOCK_STREAM : TCP
    - SOCK_DGRAM : UDP

- 메세지 송신
```int sendto (int sockfd, const void *msg, size_t len, int flags, const struct sockaddr *to, socklen_t tolen); ```
  - Parameter
    - sockfd : 소켓 디스크립터
    - msg : 송신할 메세지를 저장할 공간
    - len : 메세지 길이
    - flags : 송신 방법 -> 일반적으로 0
    - to : 상대 호스트의 정보
    - tolen : to의 바이트 단위 크기
  - Return
    - 성공 : 송신한 메세지의 크기
    - 실패 : -1

- 메세지 수신
  ```int recvfrom (int sockfd, void *buf, size_t len, int flags, const struct sockaddr *from, socklen_t fromlen); ```
  - Parameter
    - sockfd : 소켓 디스크립터
    - buf : 수신할 메세지를 저장할 공간
    - len : buf의 크기
    - flags : 수신 방법 -> 일반적으로 0
    - from : 상대 호스트의 정보
    - fromlen : from의 바이트 단위 크기
  - Return
    - 성공 : 송신한 메세지의 크기
    - 실패 : -1

** 다른 api는 TCP와 동일