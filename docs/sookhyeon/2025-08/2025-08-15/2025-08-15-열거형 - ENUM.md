# 열거형(Enum)

## 1. 문자열 사용의 문제점
### 예제 상황
- 회원 등급별 할인율 적용:
    - BASIC → 10%, GOLD → 20%, DIAMOND → 30%
- 문자열(`String`)로 등급을 전달하여 할인 계산.

### 문제
- **타입 안정성 부족**: 오타, 잘못된 값 입력 가능.
- **데이터 일관성 저하**: "GOLD", "Gold", "gold" 혼용 가능.
- **컴파일 시 오류 검출 불가**: 잘못된 값은 런타임에서만 발견.

---

## 2. 문자열 상수(`public static final`) 사용
- 상수를 사용하면 **컴파일 시 오타 감지 가능**.
- 여전히 **String 타입 자체의 한계** 존재 → 잘못된 문자열 직접 입력 가능.

---

## 3. 타입 안전 열거형 패턴(Type-Safe Enum Pattern)
- `String` 대신 **미리 정의된 객체**만 사용하도록 제한.
- 예:
  ```java
  public class ClassGrade {
      public static final ClassGrade BASIC = new ClassGrade();
      public static final ClassGrade GOLD = new ClassGrade();
      public static final ClassGrade DIAMOND = new ClassGrade();
      private ClassGrade() {}
  }
  ```
- **특징**
    - 제한된 인스턴스 생성 (`private` 생성자)
    - 타입 안정성 강화 (잘못된 값 방지)
    - 데이터 일관성 보장
- **단점**: 구현 코드가 길고 번거로움.

---

## 4. 자바 `enum` 타입
- 타입 안전 열거형 패턴을 **언어 차원에서 지원**.
- 예:
  ```java
  public enum Grade { BASIC, GOLD, DIAMOND }
  ```
- **특징**
    - `java.lang.Enum` 자동 상속.
    - 외부에서 생성 불가.
    - switch문 사용 가능.
- **장점**
    - 타입 안정성, 코드 간결성, 확장 용이성.

---

## 5. 주요 메서드
모든 열거형은 `java.lang.Enum` 상속 → 기본 메서드 제공:
- `values()` : 모든 상수 배열 반환.
- `valueOf(String name)` : 문자열 → ENUM 상수 변환.
- `name()` : 상수 이름 반환.
- `ordinal()` : 선언 순서(0부터) 반환 → ⚠ 사용 지양(상수 위치 변경 시 문제 발생).
- `toString()` : 상수 이름 반환(오버라이드 가능).

---

## 6. 리팩토링 과정
### (1) `if`문 제거 & 할인율 필드화
```java
public enum Grade {
    BASIC(10), GOLD(20), DIAMOND(30);
    private final int discountPercent;
    Grade(int discountPercent) { this.discountPercent = discountPercent; }
    public int getDiscountPercent() { return discountPercent; }
}
```
- 할인율 정보를 **등급 자체가 보관**.
- `DiscountService`에서 `if`문 제거 → `grade.getDiscountPercent()` 사용.

### (2) 캡슐화 강화
- `Grade` 내부에 `discount()` 메서드 추가 → 할인 계산 로직 이동.
```java
public int discount(int price) {
    return price * discountPercent / 100;
}
```
- 서비스 클래스 없이 `Grade.BASIC.discount(price)`처럼 사용 가능.

### (3) ENUM 반복 처리
```java
for (Grade grade : Grade.values()) {
    System.out.println(grade.name() + " : " + grade.discount(price));
}
```
- 새 등급 추가 시 `main()` 수정 없이 적용 가능.

---

## 7. 핵심 요약
- 문자열 → **오류 발생 가능** & 컴파일 타임 검증 불가.
- 타입 안전 열거형 패턴 → 안전하지만 구현 번거로움.
- **자바 `enum`** → 타입 안정성 + 간결성 + 유지보수 용이.
- `enum`은 필드, 메서드 포함 가능 → 데이터와 행동을 함께 묶는 객체지향 설계 가능.
- `ordinal()` 사용 지양, `values()`/`valueOf()` 적극 활용.
