## Ch 3. CPU

ALU(산술논리연산장치) : 연산을 수행하는 장치 (계산을 담당하는 회로)<br>
제어 장치 : 명령어를 해석하고 제어 신호를 내보내는 장치<br>
레지스터(들) : 명령어 처리 전후로 값을 임시 저장하는 장치

### 플래그 레지스터

| 부호(음수) 플래그 | 연산한 결과의 부호를 나타낸다. (1=음수, 세팅되어 있지 않으면 양수) |
| --- | --- |
| 제로 플래그 | 연산 결과가 0인지 여부를 나타낸다. |
| 캐리 플래그 | 연산 결과 올림수나 빌림수가 발생했는지 여부를 나타낸다. |
| 오버플로우 플래그 | 오버플로우가 발생했는지 여부를 나타낸다. |
| 인터럽트 플래그 | 언터럽트가 가능한지 여부를 나타낸다. |
| 슈퍼바이저 플래그 | 커널 모드로 실행 중인지, 사용자 모드로 실행 중인지를 나타낸다. |

### 시스템 버스
1. 데이터 버스
2. 주소 버스
3. 제어 버스

클럭 신호 : 부품을 일사분란하게 움직일 수 있게 하는 시간 단위

## 레지스터
1. 프로그램 카운터 : 메모리에서 가져올 명령오 주소 (메모리에서 읽어들일 주소)
2. 명령어 레지스터 : 해석할 명령어 (메모리에서 읽어들인 주소)
3. 메모리 주소 레지스터 : 메모리의 주소 (읽어들일 주소 값)
4. 메모리 버퍼 레지스터 : 메모리와 주고받을 명령어와 데이터
5. 플래그 레지스터 : 연산 결과에 대한 부가 정보 저장
6. 범용 레지스터 : 범용적으로 사용 가능한 레지스터 (여러 개 있음)
7. 스택 포인터 : 스택 주소 지정 방식에서 사용되는, ‘스택의 꼭대기’를 가리키는 레지스터
8. 베이스 레지스터 : 변위 주소 지정 방식에서 사용되는, ‘떨어진 거리’를 가리키는 레지스터

명령어 사이클 : 인출 사이클, 간접 사이클, 실행 사이클, 인터럽트 사이클<br>
인터럽트 : CPU의 정상적인 실행 흐름을 방해하는 신호<br>
동기 인터럽트 (예외) - 주로 CPU에 읭해 발생

### 비동기 인터럽트(하드웨어 인터럽트) - 주로 입출력장치에 의해 발생
1. 입출력장치는 CPU에게 인터럽트 요청 신호를 보냄
2. CPU는 실행 사이클 이후 인출 전 인터럽트 여부 확인
3. CPU는 인터럽트 요청 확인 후, 인터럽트 플래그를 통해 인터럽트 수용 여부 확인
4. 인터럽트가 가능하다면 지금까지의 작업 백업(메모리 내 스택 영역에)
5. 인터럽트 벡터를 참고하여 인터럽트 서비스 루틴(인터럽트 핸들러 실행)
6. 인터럽트 서비스 루틴 실행 후 백업한 작업 복구, 실행 재개

인터럽트 요청 신호 : CPU 작업을 방해하는 인터럽트에 대한 요청<br>
인터럽트 벡터 : 인터럽트 서비스 루틴의 시작 주소를 포함하는 인터럽트 서비스 루틴의 식별 정보<br>
인터럽트 서비스 루틴 : 인터럽트를 처리하는 프로그램

### 멀티 코어
### 멀티 프로세서

클럭 속도(Hz) : 1초에 반복된 클럭의 횟수로 측정<br>
CPU 오버클럭킹 : 오버(Over) + 클럭(Clock)

코어 : 명령어를 인출하고, 해석하고, 실행하는 CPU 내 부품

스레드
하드웨어적 스레드 : 하나의 코어가 동시에 처리하는 명령어 단위<br>
소프트웨어 스레드 : 하나의 프로그램을 독립적으로 실행하는 단위

멀티 스레드 CPU : 여러 개의 하드웨어적 스레드로 한 코어를 여러 명령어를 실행 가능한 CPU

명령어 병렬 처리 기법
## 명령어 파이프라이닝

공장의 생산 라인과 같이 명령어가 처리되는 서로 다른 단계를 동시에 처리하는 기법
1. 명령어 인출
2. 명령어 해석
3. 명령어 실행
4. 명령어 저장

주요 아이디어 : 위 단계들은 서로 겹치지만 않는다면 한꺼번에 실행할 수 있다

### 파이프라인 위험(pipeline hazard)

1. 데이터 위험(data hazard) : 명령어 간 의존성에 의해 발생
2. 제어 위험(control hazard) : 프로그램 카운터의 갑작스러운 변화에 의해 발생(분기)
3. 구조적 위험(structural hazard) : 서로 다른 명령어가 같은 자원을 사용하려 할 경우 발생

슈퍼스칼라 : 다수의 명령어 파이프라인을 두는 방식

### CISC : Complex Instruction Set Computer (Intel x86 CPU)

### RISC : Reduced Instruction Set Computer (ARM CPU)

| CISC | RISC |
| --- | --- |
| 복잡하고 다양한 명령어 | 단순하고 적은 명령어 |
| 형태와 크기가 다양한 명령어 | 짧고 규격화된 명령어 |
| 다양한 주소 지정 방식 | 메모리 접근을 단순화, 최소화 |
| 프로그램을 이루는 명령어의 수 적음 | 프로그램을 이루는 명령어의 수 많음 |
| 여러 클록에 걸쳐 명령어 수행 | 한 클록 내외로 명령어 수행 |
| 파이프라이닝하기 어려움 | 파이프라이닝하기 용이함 |

## 비순차적 명령어 처리(Out-of-Order-Execution)

파이프라이닝 내의 의존 관계가 없는 명령어를 순차적으로 처리하지 않는 방법

> **순서를 바꾸어 실행해도 프로그램 실행에 없는 명령어** 순서를 바꿈으로써 파이프라이닝의 성능을 높이는 기능
