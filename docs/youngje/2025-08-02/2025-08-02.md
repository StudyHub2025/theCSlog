## Ch 6. 보조기억장치와 입출력장치

### 하드 디스크
LP, CD/DVD 플레이어와 유사

플래터 : 하드 디스크 상에서 실질적으로 데이터가 저장되는 부분<br>
스핀들 : 플래터를 회전시키는 부분<br>
헤드 : 플래터의 데이터를 읽고 쓰는 부분<br>
디스크 암 : 헤드를 옮기는 부분


> 복수의 헤드와 플래터가 있는 경우가 많음<br>
> 플래터의 양면을 사용하는 경우가 많음

데이터 단위
- 트랙 : 플래터 상의 동심원
- 섹터 : 트랙을 나눈 단위 (가장 작은 단위)
- 실린더 : 여러 개의 트랙을 모은 단위
- 블록 : 실제 입출력이 수행되는 단위

지연 시간

1. 탐색 시간 : 헤드를 원하는 트랙까지 이동시키는 시간
2. 회전 지연 : 원하는 섹터를 헤더까지 회전시키는 시간
3. 전송 시간 : 데이터를 송수신하는 시간

### 플래시 메모리
반도체 기반의 저장 장치
> NAND 플래시 메모리(일반적으로 사용)와 NOR 플래시 메모리가 있음

저장 단위

셀(cell) : 플래시 메모리의 가장 작은 단위
> 한 셀에 몇 비트까지 저장이 가능한지 따라 플래시 메모리의 종류가 나뉨

SLC 타입 : 한 셀에 한 비트 저장 가능<br>
MLC 타입 : 한 셀에 두 비트 저장 가능<br>
TLC 타입 : 한 셀에 세 비트 저장 가능<br>
QLC 타입 : 한 셀에 네 비트 저장 가능

|  | SLC | MLC | TLC |
| --- | --- | --- | --- |
| 셀 당 bit | 1bit | 2bit | 3bit |
| 수명 | 긺 | 보통 | 짧음 |
| 읽기/쓰기 속도 | 빠름 | 보통 | 느림 |
| 안정성 | 높음 | 보통 | 낮음 |
| 가격 | 높음 | 보통 | 낮음 |
셀 < 페이지 < 블록 < 플레인 < 다이
> 읽기와 쓰기는 페이지 단위<br>
> 삭제는 블록 단위

### RAID

데이터의 안전성, 높은 성능을 위해 여러 보조기억장치를 하나처럼 사용 가능한 기술

레벨 (RAID를 구성하는 방법)<br>
**RAID 0, RAID 1**, RAID 2, RAID 3, **RAID 4, RAID 5, RAID 6**, RAID 10, RAID 50, …

RAID 0
- 데이터를 단순히 보조기억장치에 나누어 저장하는 구성 방식: 성능 개선 / 신뢰성은 감소
- 마치 줄무늬처럼 저장된 데이터: 스트라이프 = 줄무늬
- 분산하여 저장하는 것: 스트라이핑

RAID 1
- 복사본을 만드는 방식 (미러링 = 거울)
- 쓰기 성능의 감소, 저장 공간 감소, 신뢰성 증가(복구 용이)

RAID 4

- 패리티 비트(patity bit)라는 오류 검출용 비트를 저장하는 장치를 따로 두는 방식
- RAID 1에 비해 적은 하드 디스크로도 신뢰성 증가 가능
- 단, 패리티 비트를 저장한 디스크에 병목 현상이 증가


> 패리티 비트?
> - 홀수 패리티 : 전체 1의 개수가 홀수가 되도록 패리티 비트를 정하는 방식
> - 짝수 패리티 :전체 1의 개수가 짝수가 되도록 패리티 비트를 정하는 방식
> - 두 개 이상의 비트에 문제가 생길 경우 오류 검출 불가능
> - 본래 패리티 비트는 오류 검출용 비트일 뿐, 복구는 불가능
> - but, RAID에서는 어느 정도의 복구가 가능

RAID 5
- 패리티 비트를 분산하여 저장하는 방식
- RAID 4의 병목을 해소하는 방식

RAID 6
- 패리티를 두 개 두는 방식
- RAID 4 혹은 RAID 5보다 더욱 신뢰성이 높아진 방식 (단, 쓰기 성능은 감소)

nested RAID
- 여러 RAID 구성 방식을 합친 방식
- RAID 10 (RAID 1 + RAID 0), RAID 50 (RAID 5 + RAID 0)

### 입출력 장치
> 보조기억장치도 입출력장치의 일부로 볼 수 있다(주변 장치, peripheral device)<br>
> 보조기억장치의 입출력 과정은 타 입출력장치와 유사하다

CPU의 입장에서 다루기 까다로운 이유?
1. 매우 다양한 입출력장치의 종류
2. CPU와 입출력장치 간의 전송률(한 번에 주고받을 수 있는 데이터의 양) 차이

장치 컨트롤러 : 입출력 제어기(IO 컨트롤러), 입출력 모듈(IO 모듈)
- CPU와 입출력장치 간의 통신 중개
- 오류 검출
- 데이터 버퍼링(buffering, 임시로 저장했다가 내보내고)을 통한 전송률 차이 완화

장치 드라이버 : 장치 컨트롤러를 동작시키기 위한 특별한 프로그램
- 운영체제의 일부로 포함되어 있는 경우가 많음
> 입출력이란, CPU가 장치 컨트롤러와 정보를 주고 받는 것<br>
> 그것을 가능케 하는 프로그램 : 장치 드라이버

정보를 주고 받는 방법
1. 프로그램 입출력 : (입출력) 명령어를 기반으로 입출력을 수행하는 방법
2. 인터럽트 기반 입출력 : 인터럽트를 기반으로 입출력을 수행하는 방법
3. DMA(Direct Memory Access) 기반 입출력 : DMA(직접 메모리에 접근하는 방식)를 기반으로 입출력을 수행하는 방법
> DMA가 없으면 메모리가 아니라 CPU가 데이터 이동으로 주도해서 거쳐야 함

DMA(Direct Memory Access, 직접 메모리 접근)
- 입출력장치와 메모리가 CPU를 거치지 않고도 상호작용할 수 있는 입출력 방식
- 직접 메모리에 접근 가능한 입출력 기능
- DMA 컨트롤러가 필요
> 사이클 스틸링 : CPU 입장에서는 시스템 버스(공용 자원)를 사용할 사이클을 도둑맞음

입출력 버스 (입출력 전용 버스)<br>
PCI, PCI Express (PCIe) 버스

발전: 입출력 채널(입출력 전용 프로세서)<br>
(CPU가 해야하는) 입출력 명령어 해석, 실행까지 전담